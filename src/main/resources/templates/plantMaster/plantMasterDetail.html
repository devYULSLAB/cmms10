<!DOCTYPE html>
<!--
패키지: com.cmms10.plantMaster
파일: plantMasterDetail.html
프로그램명: 설비 상세정보 출력
주요기능: 설비(PlantMaster) 상세정보 출력 전용 화면
생성자: cmms10
생성일: 2024-03-19
-->
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{layout/defaultLayout}">

<head>
    <title>설비 상세정보</title>
</head>

<body>
    <div layout:fragment="content" class="content-area">
        <div class="max-w-5xl mx-auto p-4">

            <h2 class="text-2xl font-bold mb-4" th:text="#{plantMasterDetail}">설비 상세 정보</h2>

            <!-- 기본 정보 섹션 -->
            <div class="border rounded-lg p-4 shadow mb-6">
                <h5 class="text-lg font-semibold mb-4" th:text="#{basicInformation}">기본 정보</h5>
                <div class="grid grid-cols-12 gap-4">
                    <div class="col-span-3">
                        <label class="block text-sm font-medium" th:text="#{plantId}">설비 ID:</label>
                        <span class="block text-sm" th:text="${plantMaster.plantId}"></span>
                    </div>
                    <div class="col-span-9">
                        <label class="block text-sm font-medium" th:text="#{plantName}">설비명:</label>
                        <span class="block text-sm" th:text="${plantMaster.plantName}"></span>
                    </div>
                </div>
                <div class="grid grid-cols-12 gap-4 mt-4">
                    <div class="col-span-3">
                        <label class="block text-sm font-medium" th:text="#{siteId}">사업장 ID:</label>
                        <span class="block text-sm" th:text="${plantMaster.siteId}"></span>
                    </div>
                    <div class="col-span-3">
                        <label class="block text-sm font-medium" th:text="#{respDept}">담당 부서:</label>
                        <span class="block text-sm" th:text="${plantMaster.respDept}"></span>
                    </div>
                    <div class="col-span-3">
                        <label class="block text-sm font-medium" th:text="#{funcId}">기능 그룹 코드:</label>
                        <span class="block text-sm" th:text="${plantMaster.funcId}"></span>
                    </div>
                    <div class="col-span-6">
                        <label class="block text-sm font-medium" th:text="#{installDate}">설치 일자:</label>
                        <span class="block text-sm" th:text="${plantMaster.installDate}"></span>
                    </div>
                </div>
                <div class="grid grid-cols-12 gap-4 mt-4">
                    <div class="col-span-6">
                        <label class="block text-sm font-medium" th:text="#{plantLoc}">설치 위치:</label>
                        <span class="block text-sm" th:text="${plantMaster.plantLoc}"></span>
                    </div>
                </div>
            </div>

            <!-- 재무 정보 섹션 -->
            <div class="border rounded-lg p-4 shadow mb-6">
                <h5 class="text-lg font-semibold mb-4" th:text="#{financialInformation}">재무 정보</h5>
                <div class="grid grid-cols-12 gap-4 mt-4">
                    <div class="col-span-3">
                        <label class="block text-sm font-medium" th:text="#{assetType}">설비 타입:</label>
                        <span class="block text-sm" th:text="${plantMaster.assetType}"></span>
                    </div>
                    <div class="col-span-3">
                        <label class="block text-sm font-medium" th:text="#{depreMethod}">감가상각 방법:</label>
                        <span class="block text-sm" th:text="${plantMaster.depreMethod}"></span>
                    </div>
                    <div class="col-span-3">
                        <label class="block text-sm font-medium" th:text="#{acquisitionValue}">취득 가액:</label>
                        <span class="block text-sm"
                            th:text="${#numbers.formatInteger(plantMaster.acquisitionValue, 0, 'COMMA')}"></span>
                    </div>
                    <div class="col-span-3">
                        <label class="block text-sm font-medium" th:text="#{residualValue}">잔존 가액:</label>
                        <span class="block text-sm"
                            th:text="${#numbers.formatInteger(plantMaster.residualValue, 0, 'COMMA')}"></span>
                    </div>
                </div>
            </div>

            <!-- 제조 및 자산 정보 섹션 -->
            <div class="border rounded-lg p-4 shadow mb-6">
                <h5 class="text-lg font-semibold mb-4" th:text="#{manufacturerInformation}">제조 및 자산 정보</h5>
                <div class="grid grid-cols-12 gap-4">
                    <div class="col-span-3">
                        <label class="block text-sm font-medium" th:text="#{manufacturer}">제조사:</label>
                        <span class="block text-sm" th:text="${plantMaster.manufacturer}"></span>
                    </div>
                    <div class="col-span-3">
                        <label class="block text-sm font-medium" th:text="#{manufacturerModel}">모델명:</label>
                        <span class="block text-sm" th:text="${plantMaster.manufacturerModel}"></span>
                    </div>
                    <div class="col-span-3">
                        <label class="block text-sm font-medium" th:text="#{manufacturerSN}">시리얼 번호:</label>
                        <span class="block text-sm" th:text="${plantMaster.manufacturerSN}"></span>
                    </div>
                    <div class="col-span-3">
                        <label class="block text-sm font-medium" th:text="#{manufacturerSpec}">규격:</label>
                        <span class="block text-sm" th:text="${plantMaster.manufacturerSpec}"></span>
                    </div>
                </div>
            </div>

            <!-- 운영 플래그 섹션 -->
            <div class="border rounded-lg p-4 shadow mb-6">
                <h5 class="text-lg font-semibold mb-4" th:text="#{operationalFlags}">운영 플래그</h5>
                <div class="grid grid-cols-12 gap-4">
                    <div class="col-span-3">
                        <label class="block text-sm font-medium" th:text="#{inspectionYN}">검사 Y/N:</label>
                        <span class="block text-sm" th:text="${plantMaster.inspectionYN}"></span>
                    </div>
                    <div class="col-span-3">
                        <label class="block text-sm font-medium" th:text="#{plannedMaintenanceYN}">계획 점검 Y/N:</label>
                        <span class="block text-sm" th:text="${plantMaster.plannedMaintenanceYN}"></span>
                    </div>
                    <div class="col-span-3">
                        <label class="block text-sm font-medium" th:text="#{psmYN}">PSM Y/N:</label>
                        <span class="block text-sm" th:text="${plantMaster.psmYN}"></span>
                    </div>
                    <div class="col-span-3">
                        <label class="block text-sm font-medium" th:text="#{tagYN}">태그 Y/N:</label>
                        <span class="block text-sm" th:text="${plantMaster.tagYN}"></span>
                    </div>
                </div>
            </div>

            <!-- 메모 섹션 -->
            <div class="border rounded-lg p-4 shadow mb-6">
                <h5 class="text-lg font-semibold mb-4" th:text="#{note}">메모</h5>
                <div class="grid grid-cols-12 gap-4">
                    <div class="col-span-12">
                        <label class="block text-sm font-medium" th:text="#{note}">메모:</label>
                        <span class="block text-sm" th:text="${plantMaster.note}"></span>
                    </div>

                    <!-- ▼▼▼ 변경: 인쇄 시 숨김을 위해 no-print 클래스 추가 ▼▼▼ -->
                    <div class="col-span-12 no-print">
                        <label class="block text-sm font-medium" th:text="#{fileAttachment}">파일 첨부:</label>
                        <div
                            th:replace="~{common/file/listFragment :: fileListFragment(${plantMaster.companyId}, ${plantMaster.fileGroupId})}">
                        </div>
                    </div>
                    <!-- ▲▲▲ 변경 끝 ▲▲▲ -->
                </div>
            </div>

            <!-- 하단 버튼 -->
            <div class="flex space-x-4 mt-6 non-print-section">
                <a th:href="@{/plantMaster/plantMasterList}"
                    class="px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600" th:text="#{cancel}">
                    목록으로
                </a>
                <button onclick="printPlantDetail()" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">
                    <i class="fas fa-print mr-2"></i><span th:text="#{print}">출력</span>
                </button>
            </div>

            <!-- 인쇄용 스타일 -->
            <style>
                @media print {

                    /* 인쇄 시 숨길 요소들 */
                    .no-print {
                        display: none !important;
                    }

                    /* 레이아웃 숨김 */
                    header,
                    nav,
                    footer,
                    .sidebar {
                        display: none !important;
                    }

                    /* ▼▼▼ 변경: 인쇄 시 화면 본문 통째로 숨김 ▼▼▼ */
                    .content-area {
                        display: none !important;
                    }

                    /* ▲▲▲ 변경 끝 ▲▲▲ */

                    /* 인쇄용 레이아웃 */
                    body {
                        margin: 0 !important;
                        padding: 20px !important;
                        font-size: 12px !important;
                        background: white !important;
                    }

                    /* content 영역만 표시 (삭제/무의미) */

                    .print-container {
                        max-width: none !important;
                        margin: 0 !important;
                        padding: 0 !important;
                    }

                    /* 인쇄용 헤더 */
                    .print-header {
                        text-align: center;
                        margin-bottom: 20px;
                        border-bottom: 2px solid #000;
                        padding-bottom: 10px;
                    }

                    /* 인쇄용 섹션 스타일 */
                    .print-section {
                        margin-bottom: 15px;
                        page-break-inside: avoid;
                    }

                    .print-section h5 {
                        background-color: #f0f0f0 !important;
                        padding: 5px;
                        margin-bottom: 10px;
                        font-weight: bold;
                    }

                    /* 인쇄용 그리드 */
                    .print-grid {
                        display: grid;
                        grid-template-columns: repeat(12, 1fr);
                        gap: 10px;
                        margin-bottom: 10px;
                    }

                    .print-col-3 {
                        grid-column: span 3;
                    }

                    .print-col-6 {
                        grid-column: span 6;
                    }

                    .print-col-9 {
                        grid-column: span 9;
                    }

                    .print-col-12 {
                        grid-column: span 12;
                    }

                    /* 인쇄 시 관련정보 섹션 숨김 */
                    .non-print-section {
                        display: none !important;
                    }

                    /* ▼▼▼ 변경: 인쇄에선 #printContainer만 보이도록 강제 표시 ▼▼▼ */
                    #printContainer {
                        display: block !important;
                    }

                    /* ▲▲▲ 변경 끝 ▲▲▲ */
                }
            </style>

            <!-- 인쇄용 컨테이너 (숨김) -->
            <!-- 화면에서는 숨기고, 인쇄에서만 보이도록 CSS로 제어 -->
            <div id="printContainer" class="print-container" style="display: none;">
                <!-- 인쇄용 헤더 추가 -->
                <div class="print-header">
                    <h1>설비 상세 정보</h1>
                    <p>출력일시: <span id="printDateTime"></span></p>
                </div>

                <!-- 기본정보 섹션 -->
                <div class="print-grid">
                    <div class="print-col-3">
                        <div class="print-label">설비 ID:</div>
                        <div class="print-value" th:text="${plantMaster.plantId}"></div>
                    </div>
                    <div class="print-col-9">
                        <div class="print-label">설비명:</div>
                        <div class="print-value" th:text="${plantMaster.plantName}"></div>
                    </div>
                </div>
                <div class="print-grid">
                    <div class="print-col-3">
                        <div class="print-label">사업장 ID:</div>
                        <div class="print-value" th:text="${plantMaster.siteId}"></div>
                    </div>
                    <div class="print-col-3">
                        <div class="print-label">담당 부서:</div>
                        <div class="print-value" th:text="${plantMaster.respDept}"></div>
                    </div>
                    <div class="print-col-3">
                        <div class="print-label">기능 그룹 코드:</div>
                        <div class="print-value" th:text="${plantMaster.funcId}"></div>
                    </div>
                    <div class="print-col-3">
                        <div class="print-label">설치 일자:</div>
                        <div class="print-value" th:text="${plantMaster.installDate}"></div>
                    </div>
                </div>
                <div class="print-grid">
                    <div class="print-col-6">
                        <div class="print-label">설치 위치:</div>
                        <div class="print-value" th:text="${plantMaster.plantLoc}"></div>
                    </div>
                </div>

                <!-- 재무정보 섹션 -->
                <div class="print-section">
                    <h5>재무 정보</h5>
                    <div class="print-grid">
                        <div class="print-col-3">
                            <div class="print-label">설비 타입:</div>
                            <div class="print-value" th:text="${plantMaster.assetType}"></div>
                        </div>
                        <div class="print-col-3">
                            <div class="print-label">감가상각 방법:</div>
                            <div class="print-value" th:text="${plantMaster.depreMethod}"></div>
                        </div>
                        <div class="print-col-3">
                            <div class="print-label">취득 가액:</div>
                            <div class="print-value"
                                th:text="${#numbers.formatInteger(plantMaster.acquisitionValue, 0, 'COMMA')}"></div>
                        </div>
                        <div class="print-col-3">
                            <div class="print-label">잔존 가액:</div>
                            <div class="print-value"
                                th:text="${#numbers.formatInteger(plantMaster.residualValue, 0, 'COMMA')}"></div>
                        </div>
                    </div>
                </div>

                <!-- 제조 및 자산 정보 섹션 -->
                <div class="print-section">
                    <h5>제조사 정보</h5>
                    <div class="print-grid">
                        <div class="print-col-3">
                            <div class="print-label">제조사:</div>
                            <div class="print-value" th:text="${plantMaster.manufacturer}"></div>
                        </div>
                        <div class="print-col-3">
                            <div class="print-label">모델명:</div>
                            <div class="print-value" th:text="${plantMaster.manufacturerModel}"></div>
                        </div>
                        <div class="print-col-3">
                            <div class="print-label">시리얼 번호:</div>
                            <div class="print-value" th:text="${plantMaster.manufacturerSN}"></div>
                        </div>
                        <div class="print-col-3">
                            <div class="print-label">규격:</div>
                            <div class="print-value" th:text="${plantMaster.manufacturerSpec}"></div>
                        </div>
                    </div>
                </div>

                <!-- 운영 플래그 섹션 -->
                <div class="print-section">
                    <h5>운영 플래그</h5>
                    <div class="print-grid">
                        <div class="print-col-3">
                            <div class="print-label">검사 Y/N:</div>
                            <div class="print-value" th:text="${plantMaster.inspectionYN}"></div>
                        </div>
                        <div class="print-col-3">
                            <div class="print-label">계획 점검 Y/N:</div>
                            <div class="print-value" th:text="${plantMaster.plannedMaintenanceYN}"></div>
                        </div>
                        <div class="print-col-3">
                            <div class="print-label">PSM Y/N:</div>
                            <div class="print-value" th:text="${plantMaster.psmYN}"></div>
                        </div>
                        <div class="print-col-3">
                            <div class="print-label">태그 Y/N:</div>
                            <div class="print-value" th:text="${plantMaster.tagYN}"></div>
                        </div>
                    </div>
                </div>

                <!-- 메모 섹션 -->
                <div class="print-section">
                    <h5>메모</h5>
                    <div class="print-grid">
                        <div class="print-col-12">
                            <div class="print-label">메모:</div>
                            <div class="print-value" th:text="${plantMaster.note}"></div>
                        </div>
                    </div>

                    <!-- (선택) 인쇄물에 파일명만 노출하고 싶다면, 컨트롤러에서 attachFiles를 내려주세요.
                    <div class="print-grid" th:if="${attachFiles != null and #lists.size(attachFiles) > 0}">
                        <div class="print-col-12">
                            <div class="print-label">첨부 파일:</div>
                            <ul>
                                <li th:each="f : ${attachFiles}" th:text="${f.originalName}">파일명.pdf</li>
                            </ul>
                        </div>
                    </div>
                    -->
                </div>
            </div>
        </div>
    </div>
    </div>

    <!-- 페이지별 JavaScript -->
    <th:block layout:fragment="page-js">
        <script>
            function printPlantDetail() {
                // 현재 날짜시간 설정
                const now = new Date();
                const dateTimeStr = now.getFullYear() + '-' +
                    String(now.getMonth() + 1).padStart(2, '0') + '-' +
                    String(now.getDate()).padStart(2, '0') + ' ' +
                    String(now.getHours()).padStart(2, '0') + ':' +
                    String(now.getMinutes()).padStart(2, '0');

                // printDateTime 요소가 존재하는지 확인 후 설정
                const printDateTimeElement = document.getElementById('printDateTime');
                if (printDateTimeElement) {
                    printDateTimeElement.textContent = dateTimeStr;
                }

                // 인쇄용 컨테이너를 화면에 표시
                const printContainer = document.getElementById('printContainer');
                if (printContainer) {
                    printContainer.style.display = 'block';

                    // 인쇄 실행
                    window.print();

                    // 인쇄 후 인쇄용 컨테이너 숨김 (화면 복귀)
                    setTimeout(() => {
                        printContainer.style.display = 'none';
                    }, 100);
                }
            }
        </script>
    </th:block>
</body>

</html>